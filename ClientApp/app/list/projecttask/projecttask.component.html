<div class="main-content" style="margin-top:30px;">
  <div class="container-fluid">
      <div class="row">
          <div class="card card-stats">
              <div class="card-header" data-background-color="red">
                  <i class="material-icons">equalizer</i>
              </div>
              <div class="card-content"  style="padding: 0;">
                  <div class="form-group">
                      <input style="width: 30%; margin-left: 70%;" placeholder="Tìm kiếm..." type="text" class="form-control" name="search" [(ngModel)]="obj_search.name"
                          (ngModelChange)="search()">
                  </div>
              </div>
              <div class="card-footer">
                  <div class="row" style="padding: 0px 25px;">
                      <button class="btn btn-sm btn-primary" (click)="addData()"><i class="material-icons">add</i></button>
                  </div>
                  <ngx-datatable class="material" [rows]="list_data" [columnMode]="'force'" [headerHeight]="40" [footerHeight]="40" [rowHeight]="40"
                      [limit]="10" style="width:100%">
                      <ngx-datatable-column name="STT" sortable="true" >
                          <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                              {{column.name}}
                          </ng-template>
                          <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                              {{rowIndex + 1}}
                          </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Mã Dự Án" sortable="true" prop="idDuAn">
                          <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                              {{column.name}}
                          </ng-template>
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                              {{value}}
                          </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Mã Giai Đoạn" sortable="true" prop="idSprint">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                    </ngx-datatable-column>
                      <ngx-datatable-column name="Mã Công Việc" sortable="true" prop="codeCV">
                          <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                              {{column.name}}
                          </ng-template>
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                              {{value}}
                          </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Loại Công Việc" sortable="true" prop="typeCV">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Tên Công Việc" sortable="true" prop="nameCV">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Tổng Quan" sortable="true" prop="overview">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Nội Dung" sortable="true" prop="contentTask">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Thời Gian" sortable="true" prop="timeTask">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Mức Độ" sortable="true" prop="levelTask">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Người Tạo Việc" sortable="true" prop="idNguoiTaoViec">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Người Gán Việc" sortable="true" prop="idNguoiGanViec">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Trang Thái" sortable="true" prop="Status">
                        <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                            {{column.name}}
                        </ng-template>
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{value}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Hành động" sortable="true" prop="id" >
                          <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
                              {{column.name}}
                          </ng-template>
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                              <span style="color:rgb(107, 107, 107);font-size: 14px;">
                                  <i class="material-icons md-18" style="margin-right: 10px;" (click)="editData(row)">create</i>
                                  <i class="material-icons md-18" (click)="deleteRow(row)">clear</i>
                              </span>
                          </ng-template>
                      </ngx-datatable-column>
                  </ngx-datatable>

                  <!-- Modal Add EDIT -->
                  <bs-modal #modal1 [backdrop]="'static'" [keyboard]="false">
                      <form #modalForm="ngForm" (ngSubmit)="saveData()">
                          <bs-modal-header>
                              <h4 class="modal-title" *ngIf="state_type === 'new'">Thêm mới công việc</h4>
                              <h4 class="modal-title" *ngIf="state_type === 'edit'">Sửa công việc</h4>
                          </bs-modal-header>
                          <bs-modal-body>
                              <div class="row">
                                  <div class="col-sm-12">
                                    <div class="col-sm-6">
                                            <div class="form-group">
                                                    <label class="control-label">Mã Dự Án</label>
                                                    <select class="browser-default form-control" [(ngModel)]="obj_edit.idDuAn" (ngModelChange)="CheckProject()" name="idDuAn" required #idDuAn="ngModel">
                                                        <option [ngValue]="item.id" *ngFor="let item of list_project">{{item.nameProject}}</option>
                                                    </select>
                                                </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                                <label class="control-label">Mã Giai Đoạn</label>
                                                <select class="browser-default form-control" [(ngModel)]="obj_edit.idSprint" name="idSprint" required #idSprint="ngModel">
                                                    <option [ngValue]="item.idSprint" *ngFor="let item of list_sprint">{{item.nameSprint}}</option>
                                                </select>
                                            </div>
                                </div>
                                    <div class="col-sm-6">
                                      <div class="form-group">
                                          <label class="control-label">Loại Công Việc</label>
                                          <input class="form-control" [(ngModel)]="obj_edit.typeCV" name="typeCV" required #typeCV="ngModel" />
                                      </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label">Tên Công Việc</label>
                                            <input class="form-control" [(ngModel)]="obj_edit.nameCV" name="nameCV" required #nameCV="ngModel" />
                                        </div>
                                      </div>
                                    <div class="col-sm-6">
                                      <div class="form-group">
                                       <label class="control-label">Tổng Quan</label>
                                       <input class="form-control"  [(ngModel)]="obj_edit.overview" name="overview"  #overview="ngModel" />
                                     </div>
                                    </div>
                                    <div class="col-sm-6">
                                      <div class="form-group">
                                          <label class="control-label">Nội Dung</label>
                                          <input class="form-control"  [(ngModel)]="obj_edit.contentTask" name="contentTask"  #contentTask="ngModel" />
                                      </div>
                                    </div>
                                    <div class="col-sm-6">
                                      <div class="form-group">
                                          <label class="control-label">Thời Gian</label>
                                          <input class="form-control" maxlength="15" [(ngModel)]="obj_edit.timeTask" name="timeTask"  #timeTask="ngModel" />
                                      </div>
                                    </div>
                                    <div class="col-sm-6">
                                      <div class="form-group">
                                          <label class="control-label">Mức Độ</label>
                                          <select class="browser-default form-control" [(ngModel)]="obj_edit.levelTask" name="levelTask"  #levelTask="ngModel">
                                                <option [ngValue]="item.id" *ngFor="let item of list_mucDo">{{item.name}}</option>
                                            </select>
                                      </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label">Người Tạo Việc</label>
                                            <select class="browser-default form-control" [(ngModel)]="obj_edit.idNguoiTaoViec" name="idNguoiTaoViec"  #idNguoiTaoViec="ngModel">
                                                <option [ngValue]="item.id" *ngFor="let item of list_ngTaoViec">{{item.name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label">Người Gán Việc</label>
                                            <select class="browser-default form-control" [(ngModel)]="obj_edit.idNguoiGanViec" name="idNguoiGanViec"  #idNguoiGanViec="ngModel">
                                                <option [ngValue]="item.id" *ngFor="let item of list_ngGanViec">{{item.name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                            <div class="form-group">
                                                <label class="control-label">Trạng Thái</label>
                                                <select class="browser-default form-control" [(ngModel)]="obj_edit.pStatus" name="pStatus"  #pStatus="ngModel">
                                                    <option [ngValue]="item.id" *ngFor="let item of list_status">{{item.name}}</option>
                                                </select>
                                            </div>
                                        </div>
                                  </div>
                              </div>
                              <style>
                                  .label-control {
                                      margin-top: 8px;
                                  }
                              </style>
                          </bs-modal-body>
                          <bs-modal-footer>
                              <button type="button" class="btn btn-default" (click)="cancelSave()" style="margin-bottom:0;">Hủy bỏ</button>
                              <button type="submit" class="btn btn-primary">Đồng ý</button>
                          </bs-modal-footer>
                      </form>
                  </bs-modal>

                  <!-- Modal Confirm Delete -->
                  <bs-modal #confirmdeletemodal [backdrop]="'static'" [keyboard]="false">
                      <bs-modal-body>
                          <div class="container" style="padding: 10px 25px;width:100%;">
                              Xác nhận xóa
                          </div>
                      </bs-modal-body>
                      <bs-modal-footer>
                          <div style="padding-right:40px;">
                              <button type="button" class="btn btn-default-2" (click)="confirmdeletemodal.close()" style="margin-bottom:0;margin-right:10px;">Hủy bỏ</button>
                              <button type="button" (click)="removeOK()" class="btn btn-primary">
                                  Đồng ý </button>
                          </div>
                      </bs-modal-footer>
                  </bs-modal>
              </div>
          </div>
      </div>
  </div>
</div>
